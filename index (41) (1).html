<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - UID TOPUP BD</title>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    <style>
        *{margin:0;padding:0;box-sizing:border-box;font-family:Arial,sans-serif}
        body{background:#0f0f1e;color:#fff;min-height:100vh;padding:15px}
        .container{max-width:1100px;margin:0 auto;background:#1a1a2e;border-radius:20px;overflow:hidden;box-shadow:0 10px 40px rgba(0,0,0,0.6)}
        .header{background:linear-gradient(135deg,#ff1b6b,#e91e63);padding:25px;text-align:center}
        .header h1{font-size:32px;font-weight:bold}
        .tabs{display:flex;background:#111;border-bottom:2px solid #333;flex-wrap:wrap}
        .tab{padding:18px 30px;background:none;border:none;color:#ccc;font-size:17px;cursor:pointer;transition:.3s}
        .tab.active,.tab:hover{background:#e91e63;color:#fff}
        .content{padding:30px;display:none}
        .content.active{display:block}
        .stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;margin-bottom:30px}
        .stat{background:#111;padding:25px;border-radius:15px;text-align:center;border-left:5px solid #e91e63}
        .stat h3{font-size:38px;margin:10px 0;color:#ff1744}
        .orders{display:grid;gap:18px}
        .order{background:#111;padding:20px;border-radius:15px;border-left:6px solid #e91e63;transition:.3s}
        .order.confirmed{border-left-color:#4caf50;background:#102910}
        .info{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px;margin-bottom:15px}
        .info p{font-size:15px;margin:6px 0}
        .info strong{color:#2196f3}
        .actions{display:flex;gap:12px;flex-wrap:wrap}
        .btn{padding:10px 20px;border:none;border-radius:8px;font-weight:bold;cursor:pointer;transition:.3s}
        .btn-confirm{background:#4caf50;color:#fff}
        .btn-delete{background:#f44336;color:#fff}
        .btn:disabled{background:#555;cursor:not-allowed}
        .form-group{background:#111;padding:25px;border-radius:15px;margin-bottom:25px}
        .form-group input{padding:14px;width:100%;margin:12px 0;border-radius:10px;border:none;background:#222;color:#fff;font-size:16px}
        .form-group button{padding:12px 30px;background:#4caf50;color:#fff;border:none;border-radius:10px;font-size:16px;cursor:pointer}
        .current-num{font-size:18px;color:#4caf50;margin-top:10px;font-weight:bold}
        .back{position:fixed;bottom:20px;right:20px;background:#e91e63;color:#fff;padding:15px 30px;border-radius:50px;text-decoration:none;font-weight:bold;box-shadow:0 8px 25px rgba(233,30,99,0.6);z-index:1000}
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>Admin Panel - UID TOPUP BD</h1>
        <p>সবকিছু নিয়ন্ত্রণ করুন</p>
    </div>

    <div class="tabs">
        <button class="tab active" onclick="openTab('dashboard')">ড্যাশবোর্ড</button>
        <button class="tab" onclick="openTab('orders')">অর্ডারসমূহ</button>
        <button class="tab" onclick="openTab('products')">প্রোডাক্ট</button>
        <button class="tab" onclick="openTab('numbers')">নাম্বার চেঞ্জ</button>
    </div>

    <!-- Dashboard -->
    <div id="dashboard" class="content active">
        <h2 style="text-align:center;margin:20px;color:#e91e63">ড্যাশবোর্ড</h2>
        <div class="stats">
            <div class="stat"><h3 id="total-orders">0</h3><p>মোট অর্ডার</p></div>
            <div class="stat"><h3 id="pending-orders">0</h3><p>পেন্ডিং</p></div>
            <div class="stat"><h3 id="confirmed-orders">0</h3><p>কনফার্মড</p></div>
            <div class="stat"><h3 id="total-products">0</h3><p>মোট প্রোডাক্ট</p></div>
        </div>
    </div>

    <!-- Orders -->
    <div id="orders" class="content">
        <h2 style="text-align:center;margin-bottom:25px;color:#e91e63">সকল অর্ডার</h2>
        <div class="orders" id="orders-container">লোড হচ্ছে...</div>
    </div>

    <!-- Products -->
    <div id="products" class="content">
        <h2 style="text-align:center;margin-bottom:25px;color:#e91e63">প্রোডাক্ট ম্যানেজমেন্ট</h2>
        <div class="form-group">
            <input type="text" id="new-name" placeholder="প্রোডাক্টের নাম (যেমন: ১০০ ডায়মন্ড)">
            <input type="number" id="new-price" placeholder="মূল্য (টাকা)">
            <button onclick="addProduct()">প্রোডাক্ট যোগ করুন</button>
        </div>
        <div class="products-grid" id="products-container" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:18px"></div>
    </div>

    <!-- Payment Numbers -->
    <div id="numbers" class="content">
        <h2 style="text-align:center;margin-bottom:25px;color:#e91e63">পেমেন্ট নাম্বার চেঞ্জ করুন</h2>

        <div class="form-group">
            <label style="font-size:18px;color:#ff1744">বিকাশ নাম্বার</label>
            <input type="text" id="bkash-num" placeholder="যেমন: 01XXXXXXXXX">
            <button onclick="updateNumber('bkash')">বিকাশ নাম্বার আপডেট করুন</button>
            <div class="current-num">বর্তমান: <span id="current-bkash">লোড হচ্ছে...</span></div>
        </div>

        <div class="form-group">
            <label style="font-size:18px;color:#ff6b00">নগদ নাম্বার</label>
            <input type="text" id="nagad-num" placeholder="যেমন: 01XXXXXXXXX">
            <button onclick="updateNumber('nagad')">নগদ নাম্বার আপডেট করুন</button>
            <div class="current-num">বর্তমান: <span id="current-nagad">লোড হচ্ছে...</span></div>
        </div>

        <div class="form-group">
            <label style="font-size:18px;color:#00c853">রকেট নাম্বার</label>
            <input type="text" id="rocket-num" placeholder="যেমন: 01XXXXXXXXX">
            <button onclick="updateNumber('rocket')">রকেট নাম্বার আপডেট করুন</button>
            <div class="current-num">বর্তমান: <span id="current-rocket">লোড হচ্ছে...</span></div>
        </div>
    </div>
</div>

<a href="index.html" class="back">মূল সাইটে ফিরুন</a>

<script>
    const firebaseConfig = {
      apiKey: "AIzaSyBO1BfLJdUeX0KjvKvB2-MfvmoCIGj5gCI",
      authDomain: "ff-top-up-d630c.firebaseapp.com",
      projectId: "ff-top-up-d630c",
      storageBucket: "ff-top-up-d630c.firebasestorage.app",
      messagingSenderId: "337303890054",
      appId: "1:337303890054:web:fc9ef3d5dd45a8cdb34907"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // Tab
    function openTab(tabName) {
        document.querySelectorAll('.content').forEach(c => c.classList.remove('active'));
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.getElementById(tabName).classList.add('active');
        event.currentTarget.classList.add('active');
        if(tabName === 'orders') loadOrders();
        if(tabName === 'products') loadProducts();
        if(tabName === 'numbers') loadPaymentNumbers();
    }

    // Load Orders
    function loadOrders() {
        db.collection("orders").orderBy("timestamp", "desc").onSnapshot(snap => {
            const cont = document.getElementById("orders-container");
            cont.innerHTML = snap.empty ? "<p style='text-align:center;color:#666;padding:50px'>কোনো অর্ডার নেই</p>" : "";
            let total = 0, pending = 0, confirmed = 0;
            snap.forEach(doc => {
                const o = doc.data(); total++;
                if(o.status !== "confirmed") pending++; else confirmed++;
                const time = o.timestamp ? new Date(o.timestamp.toDate()).toLocaleString('bn-BD') : "অজানা";
                const div = document.createElement("div");
                div.className = "order" + (o.status==="confirmed" ? " confirmed" : "");
                div.innerHTML = `
                    <div class="info">
                        <div><p><strong>প্রোডাক্ট:</strong> ${o.product}</p><p><strong>মূল্য:</strong> ${o.price}৳</p></div>
                        <div><p><strong>Player ID:</strong> ${o.playerId}</p><p><strong>পেমেন্ট:</strong> ${o.paymentMethod.toUpperCase()}</p></div>
                        <div><p><strong>TXID:</strong> ${o.transactionId}</p><p><strong>সময়:</strong> ${time}</p></div>
                    </div>
                    <div class="actions">
                        <button class="btn btn-confirm" ${o.status==="confirmed"?"disabled":""} onclick="confirmOrder('${doc.id}')">
                            ${o.status==="confirmed"?"কনফার্মড":"কনফার্ম করুন"}
                        </button>
                        <button class="btn btn-delete" onclick="deleteOrder('${doc.id}')">ডিলিট</button>
                    </div>
                `;
                cont.appendChild(div);
            });
            document.getElementById("total-orders").textContent = total;
            document.getElementById("pending-orders").textContent = pending;
            document.getElementById("confirmed-orders").textContent = confirmed;
        });
    }

    function confirmOrder(id) { if(confirm("কনফার্ম করবেন?")) db.collection("orders").doc(id).update({status:"confirmed"}); }
    function deleteOrder(id) { if(confirm("ডিলিট করবেন?")) db.collection("orders").doc(id).delete(); }

    // Products
    function loadProducts() {
        db.collection("products").orderBy("price").onSnapshot(snap => {
            const cont = document.getElementById("products-container");
            cont.innerHTML = "";
            document.getElementById("total-products").textContent = snap.size;
            snap.forEach(doc => {
                const p = doc.data();
                const div = document.createElement("div");
                div.innerHTML = `<strong>${p.name}</strong> - ${p.price}৳ <button style="float:right;background:#f44336;color:#fff;border:none;padding:8px 15px;border-radius:8px;cursor:pointer" onclick="db.collection('products').doc('${doc.id}').delete()">রিমুভ</button>`;
                div.style = "background:#111;padding:20px;border-radius:15px;text-align:center";
                cont.appendChild(div);
            });
        });
    }

    function addProduct() {
        const name = document.getElementById("new-name").value.trim();
        const price = parseInt(document.getElementById("new-price").value);
        if(name && price > 0) {
            db.collection("products").add({name, price}).then(() => {
                alert("প্রোডাক্ট যোগ হয়েছে!");
                document.getElementById("new-name").value = "";
                document.getElementById("new-price").value = "";
            });
        } else alert("সঠিক তথ্য দিন!");
    }

    // Payment Numbers
    function loadPaymentNumbers() {
        const docRef = db.collection("settings").doc("paymentNumbers");
        docRef.onSnapshot(doc => {
            if(doc.exists) {
                const data = doc.data();
                document.getElementById("current-bkash").textContent = data.bkash || "সেট করা হয়নি";
                document.getElementById("current-nagad").textContent = data.nagad || "সেট করা হয়নি";
                document.getElementById("current-rocket").textContent = data.rocket || "সেট করা হয়নি";
            }
        });
    }

    function updateNumber(type) {
        const num = document.getElementById(type + "-num").value.trim();
        if(!num || num.length < 11) return alert("সঠিক নাম্বার দিন!");
        db.collection("settings").doc("paymentNumbers").set({
            [type]: num
        }, { merge: true }).then(() => {
            alert(type.toUpperCase() + " নাম্বার আপডেট হয়েছে!");
            document.getElementById(type + "-num").value = "";
        });
    }

    // Start
    loadOrders();
    loadProducts();
    loadPaymentNumbers();
</script>
    <!-- Footer -->
    <footer style="text-align: center; padding: 15px 0; background-color: #f0f0f0; margin-top: 40px; font-size: 14px; color: #555;">
        © 2025 All rights reserved | Developed By MD ABDULLH KHAN
    </footer>
</body>
</html>
